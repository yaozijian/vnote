# 无畏安全（一）：内存安全

常见的内存安全问题：

* 释放后使用
* 解引用空指针
* 使用未初始化的内存
* 多次释放
* 缓冲区溢出

## 1 内存管理

指针是内存管理中的一个关键概念。滥用指针将导致安全风险，包括信息泄露和任意代码执行。

### 1.1 分配/释放

* 创建变量时，需要分配足够的内存以存储变量的数据
* 每个进程可使用的内存有限，应及时释放不再使用的内存
* 内存释放后，可用于存储新的数据，但旧的数据一直存在，直到被覆盖

### 1.2 缓冲区

* `Buffer`是存储多个相同类型实例的一块连续内存区域
* 缓冲区由起始地址和长度定义
* 存储在临近缓冲区的内存中的数据可能是无关的，所以读写缓冲区时不得越界

### 1.3 控制流

* 程序由子例程（subroutine）构成，子例程以特定的次序执行
* 子例程结束时，流程跳转，此时可能会

1. 进程按预期的方式继续运行（返回地址未被破坏）
2. 进程崩溃（返回地址被修改，指向不可执行内存）
3. 进程以非预期的方式继续（返回地址被修改，控制流被修改）

## 2 语言怎么达到内存安全

### 2.1 手动内存管理

手动管理内存要求指定什么时候分配内存、分配多少，以及什么时候释放内存。这让程序员能够更好地控制如何使用资源，实现高效的代码。
然而，手动管理内存常导致错误，特别是在复杂的代码中。常犯的错误有：

* 忘记资源已经释放，企图使用
* 未分配足够容纳数据的空间
* 读取时越过缓冲区边界

### 2.2 智能指针


